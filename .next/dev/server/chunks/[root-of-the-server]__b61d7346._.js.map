{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/yugansh/Downloads/inventory-management-system%20%281%29/lib/server-auth-store.ts"],"sourcesContent":["import fs from 'fs'\nimport path from 'path'\n\nconst AUTH_DATA_FILE = path.join(process.cwd(), 'data', 'auth.json')\n\n// Ensure data directory exists\nfunction ensureDataDir() {\n  const dataDir = path.dirname(AUTH_DATA_FILE)\n  if (!fs.existsSync(dataDir)) {\n    fs.mkdirSync(dataDir, { recursive: true })\n  }\n}\n\nconst defaultAuthData = {\n  users: {\n    \"demo@example.com\": { password: \"demo123\", name: \"Demo User\", role: \"admin\" },\n    \"yuganshvthacker@gmail.com\": { password: \"\", name: \"Yugansh Thacker\", role: \"admin\" },\n  }\n}\n\nexport const serverAuthStore = {\n  getAuthData: () => {\n    ensureDataDir()\n    try {\n      if (fs.existsSync(AUTH_DATA_FILE)) {\n        const data = fs.readFileSync(AUTH_DATA_FILE, 'utf8')\n        return JSON.parse(data)\n      } else {\n        // Create default data file\n        fs.writeFileSync(AUTH_DATA_FILE, JSON.stringify(defaultAuthData, null, 2))\n        return defaultAuthData\n      }\n    } catch (error) {\n      console.error('Error reading auth data:', error)\n      return defaultAuthData\n    }\n  },\n\n  saveAuthData: (data: any) => {\n    ensureDataDir()\n    try {\n      fs.writeFileSync(AUTH_DATA_FILE, JSON.stringify(data, null, 2))\n    } catch (error) {\n      console.error('Error saving auth data:', error)\n    }\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAExD,+BAA+B;AAC/B,SAAS;IACP,MAAM,UAAU,4GAAI,CAAC,OAAO,CAAC;IAC7B,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,UAAU;QAC3B,wGAAE,CAAC,SAAS,CAAC,SAAS;YAAE,WAAW;QAAK;IAC1C;AACF;AAEA,MAAM,kBAAkB;IACtB,OAAO;QACL,oBAAoB;YAAE,UAAU;YAAW,MAAM;YAAa,MAAM;QAAQ;QAC5E,6BAA6B;YAAE,UAAU;YAAI,MAAM;YAAmB,MAAM;QAAQ;IACtF;AACF;AAEO,MAAM,kBAAkB;IAC7B,aAAa;QACX;QACA,IAAI;YACF,IAAI,wGAAE,CAAC,UAAU,CAAC,iBAAiB;gBACjC,MAAM,OAAO,wGAAE,CAAC,YAAY,CAAC,gBAAgB;gBAC7C,OAAO,KAAK,KAAK,CAAC;YACpB,OAAO;gBACL,2BAA2B;gBAC3B,wGAAE,CAAC,aAAa,CAAC,gBAAgB,KAAK,SAAS,CAAC,iBAAiB,MAAM;gBACvE,OAAO;YACT;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO;QACT;IACF;IAEA,cAAc,CAAC;QACb;QACA,IAAI;YACF,wGAAE,CAAC,aAAa,CAAC,gBAAgB,KAAK,SAAS,CAAC,MAAM,MAAM;QAC9D,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C;IACF;AACF"}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///Users/yugansh/Downloads/inventory-management-system%20%281%29/app/api/auth/verify-otp/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { serverAuthStore } from '@/lib/server-auth-store'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, otp } = await request.json()\n\n    if (!email || !otp) {\n      return NextResponse.json(\n        { error: 'Email and OTP are required' },\n        { status: 400 }\n      )\n    }\n\n    // Get auth data from server-side storage\n    const authData = serverAuthStore.getAuthData()\n    const user = authData.users[email]\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'Email not found' },\n        { status: 404 }\n      )\n    }\n\n    if (!user.otpCode || user.otpCode !== otp) {\n      return NextResponse.json(\n        { error: 'Invalid OTP' },\n        { status: 400 }\n      )\n    }\n\n    if (user.otpExpiry && user.otpExpiry < Date.now()) {\n      return NextResponse.json(\n        { error: 'OTP expired' },\n        { status: 400 }\n      )\n    }\n\n    // Clear OTP after successful verification\n    user.otpCode = undefined\n    user.otpExpiry = undefined\n    serverAuthStore.saveAuthData(authData)\n\n    return NextResponse.json(\n      { message: 'OTP verified successfully' },\n      { status: 200 }\n    )\n  } catch (error) {\n    console.error('OTP verification error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEzC,IAAI,CAAC,SAAS,CAAC,KAAK;YAClB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA6B,GACtC;gBAAE,QAAQ;YAAI;QAElB;QAEA,yCAAyC;QACzC,MAAM,WAAW,mJAAe,CAAC,WAAW;QAC5C,MAAM,OAAO,SAAS,KAAK,CAAC,MAAM;QAElC,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkB,GAC3B;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,KAAK,OAAO,IAAI,KAAK,OAAO,KAAK,KAAK;YACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAc,GACvB;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,KAAK,SAAS,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,IAAI;YACjD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAc,GACvB;gBAAE,QAAQ;YAAI;QAElB;QAEA,0CAA0C;QAC1C,KAAK,OAAO,GAAG;QACf,KAAK,SAAS,GAAG;QACjB,mJAAe,CAAC,YAAY,CAAC;QAE7B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAA4B,GACvC;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}